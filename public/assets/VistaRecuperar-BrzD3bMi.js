import{a as f,b as a,w as g,f as p,k as w,v as k,r as o,n as y,t as C,l as T,m as N,p as P,q,s as D,g as E,e as b,j as S,c as x}from"./index-kENfiCDL.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const B={id:"recover-main"},I={class:"recover-box"},_=["open"],h=["type"],z={class:"show-password-container"},A={class:"back-to-login"},$={__name:"VistaRecuperar",setup(F){const V=E(),i=o(""),r=o(""),l=o(""),v=o(!1),c=o(""),n=o(""),m=o(!1),t=o(""),u=o(""),j=async()=>{if(r.value="",l.value="",!i.value.trim()){r.value="Por favor ingresa tu correo electrónico",l.value="error-msg";return}try{await x.enviar("/api/recover",{correo:i.value.trim()}),r.value="Correo enviado. Revisa tu bandeja de entrada e ingresa el código.",l.value="success-msg",v.value=!0}catch(d){r.value=d.message,l.value="error-msg"}},M=async()=>{if(t.value="",u.value="",!c.value.trim()||!n.value||n.value.length<6){t.value="Ingresa el código y la nueva contraseña (mín. 6 caracteres)",u.value="error-msg";return}try{await x.enviar("/api/recover/change",{tokenTemporal:c.value.trim(),nuevaClave:n.value}),t.value="Contraseña actualizada. Redirigiendo...",u.value="success-msg",setTimeout(()=>V.push("/login"),2e3)}catch(d){t.value=d.message,u.value="error-msg"}};return(d,e)=>{const R=D("router-link");return b(),f("main",B,[a("section",I,[e[12]||(e[12]=a("h2",null,"Recuperar Contraseña",-1)),a("form",{onSubmit:g(j,["prevent"]),class:"recover-form"},[e[5]||(e[5]=a("label",{for:"recover-user"},"Correo Electrónico",-1)),p(a("input",{type:"email",id:"recover-user","onUpdate:modelValue":e[0]||(e[0]=s=>i.value=s),class:"form-input",placeholder:"usuario@ejemplo.com",required:"",autocomplete:"email",autofocus:""},null,512),[[k,i.value]]),e[6]||(e[6]=a("button",{type:"submit",class:"btn"},"Solicitar enlace de recuperación",-1)),r.value?(b(),f("p",{key:0,class:y(l.value)},C(r.value),3)):w("",!0)],32),a("details",{open:v.value,class:"recover-token-details"},[a("summary",{onClick:e[1]||(e[1]=g(s=>v.value=!v.value,["prevent"]))},"Tengo el código de recuperación"),a("form",{onSubmit:g(M,["prevent"]),class:"recover-form"},[e[8]||(e[8]=a("label",{for:"recover-token"},"Ingresa el código de verificación",-1)),p(a("input",{type:"text",id:"recover-token","onUpdate:modelValue":e[2]||(e[2]=s=>c.value=s),class:"form-input",placeholder:"123456",required:"",maxlength:"6",pattern:"[0-9]*"},null,512),[[k,c.value]]),e[9]||(e[9]=a("label",{for:"recover-new-pass"},"Nueva contraseña",-1)),p(a("input",{type:m.value?"text":"password",id:"recover-new-pass","onUpdate:modelValue":e[3]||(e[3]=s=>n.value=s),class:"form-input",required:"",minlength:"6"},null,8,h),[[T,n.value]]),a("div",z,[p(a("input",{type:"checkbox",id:"show-password","onUpdate:modelValue":e[4]||(e[4]=s=>m.value=s),class:"show-password-checkbox"},null,512),[[N,m.value]]),e[7]||(e[7]=a("label",{for:"show-password",class:"show-password-label"},"Mostrar contraseña",-1))]),e[10]||(e[10]=a("button",{type:"submit",class:"btn"},"Establecer nueva contraseña",-1)),t.value?(b(),f("p",{key:0,class:y(u.value)},C(t.value),3)):w("",!0)],32)],8,_),a("div",A,[P(R,{to:"/login"},{default:q(()=>[...e[11]||(e[11]=[S("← Volver al inicio de sesión",-1)])]),_:1})])])])}}},J=U($,[["__scopeId","data-v-f7b55d98"]]);export{J as default};
